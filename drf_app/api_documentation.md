# Документация по API

### 1. Регистрация пользователя
URL: ```/api/v1/create_user/```  
Разрешенные методы: ```POST```  
Доступ: ```Неавторизированные пользователи```  
Тело запроса:
```
{
    "username": "username",
    "first_name": "name",
    "last_name": "surname",
    "email": "api@mail.ru",
    "password1": "your_password",
    "password2": "your_password"
}  
```
Обязательные поля: ```username```, ```first_name```, ```last_name```, ```email```, ```password1```, ```password2```

### 2. Получение, изменение и удаление данных пользователя
URL: ```/api/v1/update_delete_user/username/```    
```username``` - username пользователя, чьи данные необходимо изменить.   
Разрешенные методы: ```GET, PUT, DELETE```
Доступы: ```Авторизированнные пользователи, владелец``` 
1. Получение текущих данных пользователя  
Отправьте ```GET-запрос``` без передачи дополнительных данных.
2. Изменение данных пользователя  
Допускается изменение ```first_name``` и/или ```last_name```. Для этого отправьте ```PUT-запрос``` с телом:
```
{
    "first_name": "new_name",
    "last_name": "new_surname"
}
```
3. Удаление данных пользователя  
Отправьте ```DELETE-запрос``` без передачи дополнительных данных.

### 3. Создание портфолио парикмахера
URL: ```/api/v1/create_hairdresser/```  
Разрешенные методы: ```POST```  
Доступ: ```Авторизированнные пользователи```  
Тело запроса:
```
{
    "city": city_id,
    "phone": "+375291234567",
    "skills": [skill_id, skill_id],
    "instagram": "your_instagram_username",
    "another_info": "Стоимость стрижки - 5 рублей."
}
```
Обязательные поля: ```city```, ```phone```, ```skills```  
```city_id``` - числовой идентификатор города, который можно получить, отправив ```GET-запрос``` по адресу ```/api/v1/get_cities/```  
```skill_id``` - список числовых идентификаторов навыков, которые можно получить, отправив ```GET-запрос``` по адресу ```/api/v1/get_skills/```.

### 4. Добавление фото в портфолио парикмахера
URL: ```/api/v1/add_photo_to_portfolio/hairdresser_username/```
```hairdresser_username``` - username парикмахера, в чье портфолио необходимо добавить фото.  
Разрешенные методы: ```POST```  
Доступ: ```Авторизированнные пользователи, владелец```  
Тело запроса:
```
{
    "images": [
        "/9j/....0CEIQf/Z", 
        "/9j/....0KERQf/Z"
    ]
}
```
Обязательные поля: ```images```  
```images``` - список изображений, ```предварительно закодированных по стандарту base64```. Максимальный размер портфолио - ```15 изображений```. В случае максимальной заполненности портфолио, при загрузке новых изображений ```будут автоматически удалены наиболее старые изображения``` в портфолио пользователя.
### 5. Удаление всех фото из портфолио
URL: ```/api/v1/remove_all_photo_from_portfolio/hairdresser_username/```
```hairdresser_username``` - username парикмахера, чьи фото в портфолио необходимо удалить.
Разрешенные методы: ```DELETE``` 
Доступ: ```Авторизированнные пользователи, владелец```  
Данный запрос ```удаляет все фото``` в портфолио.
### 6. Просмотр портфолио парикмахера
URL: ```/api/v1/get_hairdresser/hairdresser_username/```
```hairdresser_username``` - username парикмахера, чье портфолио необходимо посмотреть.  
Разрешенные методы: ```GET```  
Доступ: ```Все пользователи```  

### 7. Изменение или удаление портфолио парикмахера
URL: ```/api/v1/update_delete_hairdresser/hairdresser_username/```
```hairdresser_username``` - username парикмахера, чье портфолио необходимо изменить / удалить.  
Разрешенные методы: ```PUT, DELETE```   
Доступ: ```Авторизированнные пользователи, владелец```  
1. Изменение портфолио  
Вы можете изменить следующие поля: ```phone```, ```city```, ```skills```, ```another_info```, ```instagram```. Для этого необходимо отправить ```PUT-запрос``` с телом, содержащим поля, данные которых необходимо изменить:  
```
{
    "city": 5,
    "skills": [1, 2, 3],
    "another_info": "Стрижка - 10руб."
}
```
Все старые данные ```будут перезаписаны``` согласно новым переданным данным. Т.е., если Вы хотите добавить в портфолио один новый навык, то Вам необходимо передать полный список навыков, которые Вы хотите видеть в портфолио.
2. Удаление портфолио  
Отправьте ```DELETE-запрос``` без передачи дополнительных данных.
### 8. Подбор парикмахеров
URL: ```/api/v1/get_hairdresser/selection/```
Разрешенные методы: ```GET```  
Доступ: ```Все пользователи```  
Тело запроса
```
{
    "city": city_id,
    "skills": [skill_id, skill_id]
}
```
```city_id``` - числовой идентификатор города, который можно получить, отправив ```GET-запрос``` по адресу ```/api/v1/get_cities/```  
```skill_id``` - список числовых идентификаторов навыков, которые можно получить, отправив ```GET-запрос``` по адресу ```/api/v1/get_skills/```.  
Допускается передавать один из параметров.
### 9. Добавление отзывов
URL: ```/api/v1/add_comment/hairdresser_username/```  
```hairdresser_username``` - username парикмахера, к которому добавляете отзыв.  
Разрешенные методы: ```POST```  
Доступ: ```Авторизированнные пользователи```  
Тело запроса
```
{
    "text": "текст отзыва",
    "rating_value": 5
}
```
Обязательные поля: ```text```, ```rating_value```  
```text``` - текст отзыва, содержащий ```не менее 10 символов```.  
```rating_value``` - оценка парикмахера. Представляет собой ```целое число в диапазоне от 0 до 5 включительно.```  
За один день допускается оставлять ```только 1 (один) отзыв на конкретного парикмахера!```
### 10. Просмотр отзывов
URL: ```/api/v1/comments/hairdresser_username/```
```hairdresser_username``` - username парикмахера, отзывы о котором хотите посмотреть.  
Разрешенные методы: ```GET```  
Доступ: ```Все пользователи```  

### 11. Авторизация
Авторизация происходит с помощью JWT-токена.
1. На URL ```/api/v1/token/``` отправьте ```POST-запрос```, передав в тело запроса ```username``` и ```password``` пользователя:
```
{
    "username": "your_username",
    "password": "your_password"
}
```
При валидном запросе вы получите ответ с двумя видами токенов вида:
```
{
    "refresh": "eyJ0...Idbg",
    "access": "eyJ0...uvWk"
}
```
2. Используйте ```access-токен``` при выполнении запросов, требующих авторизацию, передавая его в заголовках запроса в следующем виде:
```
Key: Authorization
Value: Token eyJ0...uvWk
```
Время жизни ```access-токена``` - ```5 минут```.
3. Получить новый ```access-токен``` можно отправив ```POST-запрос``` на URL ```/api/v1/token/refresh/```, передав в тело запроса ваш текущий ```refresh-токен```:
```
{
    "refresh": "eyJ0...uvWk"
}
```